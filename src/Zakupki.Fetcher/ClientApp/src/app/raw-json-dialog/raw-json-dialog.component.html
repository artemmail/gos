<div mat-dialog-title class="dialog-title">
  <h2 class="dialog-title-text">JSON закупки {{ data.purchaseNumber }}</h2>
  <button
    mat-icon-button
    type="button"
    (click)="toggleFullscreen()"
    [attr.aria-label]="isFullscreen ? 'Свернуть диалог' : 'Развернуть диалог на весь экран'"
  >
    <mat-icon>{{ isFullscreen ? 'fullscreen_exit' : 'fullscreen' }}</mat-icon>
  </button>
</div>

<mat-dialog-content class="dialog-content">
  <div class="entry-name" *ngIf="data.entryName">{{ data.entryName }}</div>

  <div *ngIf="parseError; else treeTemplate" class="parse-error">{{ parseError }}</div>

  <ng-template #treeTemplate>
    <mat-tree [dataSource]="dataSource" [treeControl]="treeControl" class="json-tree">
      <mat-tree-node *matTreeNodeDef="let node" matTreeNodePadding>
        <button mat-icon-button disabled></button>
        <span class="node-key">{{ node.key }}:</span>
        <span class="node-value">{{ node.value }}</span>
      </mat-tree-node>

      <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild" matTreeNodePadding>
        <div class="node-header">
          <button mat-icon-button matTreeNodeToggle>
            <mat-icon>
              {{ treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right' }}
            </mat-icon>
          </button>
          <span class="node-key">{{ node.key }}</span>
          <span class="node-meta" *ngIf="node.type === 'array'">[{{ node.children?.length || 0 }}]</span>
        </div>
        <div class="node-children" *ngIf="treeControl.isExpanded(node)">
          <ng-container matTreeNodeOutlet></ng-container>
        </div>
      </mat-nested-tree-node>
    </mat-tree>
  </ng-template>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button mat-dialog-close>Закрыть</button>
</mat-dialog-actions>
